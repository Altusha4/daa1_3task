# Deterministic Select (Median-of-Medians, MoM5)

## 1) Архитектура и контроль глубины/аллокаций
- Группировка по 5, сортировка вставками групп, перенос медиан групп во «фронт».
- Рекурсивный выбор **медианы медиан** как опорного значения.
- **In-place** разбиение (Ломуто) вокруг опорного значения.
- Рекурсия только в нужную сторону; стратегия **smaller-first** (в меньший сегмент — рекурсией, в больший — хвостом через цикл). Это ограничивает стек до `O(log n)`.
- Доп. массивов не создаём (аллокации ≈ 0), кроме копии во внешнем API, чтобы не портить вход.

Собираемые метрики: `comparisons, swaps, allocations, maxRecursionDepth, elapsedNanos`.

## 2) Рекуррентность и оценка
MoM5 гарантирует после разбиения сегменты не больше `7n/10`. Рекуррентность: T(n) = T(⌈n/5⌉) + T(≤ 7n/10) + Θ(n)

Master Theorem напрямую не применим; по **интуиции Акры–Баззи** линейная часть доминирует → итог **Θ(n)** в худшем случае.

## 3) Эксперимент (n = 20 000, случайные int)
| k      | ok | time, ms | comparisons | swaps | depth |
|--------|----|----------|-------------|-------|-------|
| 0      | ✔  | 19.649   | 168116      | 37782 | 10    |
| 5000   | ✔  | 53.485   | 172763      | 38950 | 10    |
| 10000  | ✔  | 5.491    | 168314      | 38325 | 10    |
| 15000  | ✔  | 4.432    | 170406      | 38782 | 10    |
| 19999  | ✔  | 4.356    | 170468      | 38786 | 10    |

**Наблюдения.** Сравнения ~линейны от n (около 170k). Глубина ~10 ≈ `log2(20000)`. Время колеблется (кэш/ветвления/локальные эффекты JVM), но остаётся на уровне квази-линейного роста (в рамках теории Θ(n)).

## 4) Итог
- Теория совпала с практикой по форме: линейное время и логарифмическая глубина.
- Константа времени у MoM5 выше, чем у randomized select, зато есть **жёсткая гарантия Θ(n)** в худшем случае.

